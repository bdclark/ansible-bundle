---
language: python
python:
  - "2.7"
services: docker

stages:
  - lint
  - test
  - deploy

env:
  global:
    - ANSIBLE_VERSION=2.9.11
  matrix:
    - DOCKERFILE="Dockerfile.centos" IMAGE="centos:7"
    # - DOCKERFILE="Dockerfile.centos" IMAGE="centos:8"
    # - DOCKERFILE="Dockerfile.debian" IMAGE="debian:jessie-slim"
    # - DOCKERFILE="Dockerfile.debian" IMAGE="debian:stretch-slim"
    # - DOCKERFILE="Dockerfile.debian" IMAGE="debian:buster-slim"
    # - DOCKERFILE="Dockerfile.debian" IMAGE="ubuntu:16.04"
    # - DOCKERFILE="Dockerfile.debian" IMAGE="ubuntu:18.04"
    # - DOCKERFILE="Dockerfile.debian" IMAGE="ubuntu:20.04"

install:
  - pip install tox
  - pip install --upgrade pip

script:
  - python --version
  - python -m pip --version
  # - tox -e build -- "$ANSIBLE_VERSION"
  - .travis/test.sh

jobs:
  include:
    - stage: lint
      # install: pip install tox
      install: pip install flake8 flake8-docstrings pydocstyle flake8-isort flake8-typing-imports pep8-naming flake8-black
      script:
        - python -m pip --version
        - python --version
    - stage: deploy
      script: echo "Deploying to GitHub releases ..."
